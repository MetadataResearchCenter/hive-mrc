<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
  <title>Term Suggester</title>

  <script src="/jquery/jquery-1.5.1.js"></script>	
  <script src="/jquery/dynatree/jquery-ui.custom.js" type="text/javascript"></script>
  <script src="/jquery/dynatree/jquery.cookie.js" type="text/javascript"></script>

  <link href="/jquery/dynatree/ui.dynatree.css" rel="stylesheet" type="text/css">
  <script src="/jquery/dynatree/jquery.dynatree.js" type="text/javascript"></script>
<style>
ul.dynatree-container
{
	white-space: nowrap;
	padding-top: 3px;
	margin-top: -3px;
	background-color: #FAF8CC;
	border: 1px solid gray;
	overflow: auto;
}

</style>
  <!-- (Irrelevant source removed.) -->

<script type="text/javascript">

	var cv = 'agrovoc';
	var mp = 1;
	
	function changeSource(cv) {
		this.cv = cv;
	}
	
	function changeMP(mp) {
		this.mp = mp;
	}
	
  function loadTree()
  {
	  var text = document.getElementById('text');
	  var container = document.getElementById('treecontainer');
	  container.style.display = 'block';
	  $("#tree").dynatree("destroy");
	  $("#tree").dynatree({
		  title: "Suggested Terms",
	      checkbox: true,
	      selectMode: 2,
	      minExpandLevel: 10,
	      initAjax: {
	          url: "/suggest?cv=" + cv + "&text=" + text.value + "&mp=" + mp
	      },
	      onSelect: function(select, node) {
	        // Display list of selected nodes
	        var selNodes = node.tree.getSelectedNodes();
	        // convert to title/key array
	        var selKeys = $.map(selNodes, function(node){
	             return "[" + node.data.key + "]: '" + node.data.title + "'";
	        });
	        $("#echoActive").text(selKeys.join(", "));
	      },
	      onClick: function(node, event) {
	        // We should not toggle, if target was "checkbox", because this
	        // would result in double-toggle (i.e. no toggle)
	        if( node.getEventTargetType(event) == "title" )
	          node.toggleSelect();
	      },
	      onActivate: function(node) {

	          if( node.data.url )
	            window.open(node.data.url);
	        },
	      onKeydown: function(node, event) {
	        if( event.which == 32 ) {
	          node.toggleSelect();
	          return false;
	        }
	      },
	      // The following options are only required, if we have more than one tree on one page:
	      cookieId: "dynatree-Cb2",
	      idPrefix: "dynatree-Cb2-"
	    });
  }
  
  $(function(){

  });
  
  


  
</script>
</head>

<body class="example">
  <div id="form" style="float:left">
	  <form>
	  	<textarea id="text" style="width:300px; display:block; margin-right: 20px" rows="10"></textarea>
		<select id="cv" onchange="changeSource(this.options[this.selectedIndex].id)">
			<option id="agrovoc">AGROVOC</option>
			<option id="itis">ITIS</option>
			<option id="lcsh">LCSH</option>
			<option id="nbii">NBII</option>	
			<option id="tgn">TGN</option>
		</select>
		<select id="mp" onchange="changeMP(this.options[this.selectedIndex].id)">
			<option id="1">1</option>
			<option id="2">2</option>
			<option id="3">3</option>
		</select>
	  	<input type="button" name="Suggest" value="Suggest" onclick="loadTree();">
	  </form>
 </div>
 <div id="treecontainer" style="display: none; float: left; overflow: auto;">
  <div id="title" style="background-color: #FAF8CC; margin: 0px;  border: 1px solid gray;width: 310px; ">
  <font style="padding-left: 5px; font-family: tahoma, arial, helvetica; font-size: 10pt; font-weight: bold">Suggested Terms: <a href="link_to_hive">?</a></font>
  </div>
  <div id="tree"></div>
 </div>


  <div id style="display:block"><span id="echoActive"></span></div>

</body>
</html>